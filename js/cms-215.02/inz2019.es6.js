var inz=window.inz||{};inz.inz2019Ready=function(){inz.commonLayout.init();inz.header.init();inz.footer.init();if(typeof inz.nav!=="undefined"){inz.nav.init()}if(typeof inz.nav2023!=="undefined"){inz.nav2023.init()}inz.genericContent.init();inz.advancedImages.init();inz.viewport.init()};inz.viewport=inz.viewport||{};inz.viewport.isTabletOrSmaller=function(){return window.matchMedia("(max-width: 944px)").matches};inz.viewport.EVENT_INZ_ADJUST_LAYOUT="inz_adjust_layout";inz.viewport.init=function(){function fireINZAdjustLayout(){document.dispatchEvent(new CustomEvent("inz_adjust_layout"))}window.addEventListener("resize",function(){fireINZAdjustLayout()});fireINZAdjustLayout()};


inz.commonLayout={};inz.commonLayout.elements={};inz.commonLayout.init=function(){inz.commonLayout.elements.bottomRightOverlays=$("#bottom_right_overlays");inz.commonLayout.elements.inzPageHeader=$("header.inz_page_header");inz.commonLayout.elements.backToTopButton=null;inz.commonLayout.initBackToTop()};inz.commonLayout.initBackToTop=function(){if(!inz.commonLayout.isBackToTopRequested()){return}inz.commonLayout.elements.backToTopButton=$("<button>",{id:"back_to_top",title:"Back to Top",click:()=>{window.scrollTo(0,0);inz.commonLayout.updateBackToTopButtonPosition()}});inz.commonLayout.elements.bottomRightOverlays.prepend(inz.commonLayout.elements.backToTopButton);window.addEventListener("scroll",()=>{inz.commonLayout.updateBackToTopButtonPosition()});inz.commonLayout.elements.backToTopButton.on("transitionend",()=>{inz.commonLayout.updateBackToTopButtonDisplay()});inz.commonLayout.updateBackToTopButtonPosition();inz.commonLayout.updateBackToTopButtonDisplay();setTimeout(()=>{inz.commonLayout.elements.backToTopButton.addClass("with_transition")},250)};inz.commonLayout.isBackToTopRequested=function(){return $(document.body).is("[data-back-to-top]")};inz.commonLayout.isHeaderOutOfView=function(){let result;if(inz.commonLayout.elements.inzPageHeader.length){result=inz.commonLayout.elements.inzPageHeader.offset().top+inz.commonLayout.elements.inzPageHeader.outerHeight()<window.visualViewport.pageTop}else{result=window.visualViewport.pageTop/window.visualViewport.height>.33}return result};inz.commonLayout.shouldShowBackToTop=function(){return inz.commonLayout.isHeaderOutOfView()};inz.commonLayout.updateBackToTopButtonPosition=function(){if(inz.commonLayout.elements.backToTopButton.hasClass("hidden")&&inz.commonLayout.shouldShowBackToTop()){inz.commonLayout.updateBackToTopButtonDisplay()}inz.commonLayout.elements.backToTopButton.toggleClass("hidden",!inz.commonLayout.shouldShowBackToTop())};inz.commonLayout.updateBackToTopButtonDisplay=function(){inz.commonLayout.elements.backToTopButton.css("display",inz.commonLayout.shouldShowBackToTop()?"inline-block":"none")};


var __accessCheck=(obj,member,msg)=>{if(!member.has(obj))throw TypeError("Cannot "+msg)};var __privateGet=(obj,member,getter)=>{__accessCheck(obj,member,"read from private field");return getter?getter.call(obj):member.get(obj)};var __privateAdd=(obj,member,value)=>{if(member.has(obj))throw TypeError("Cannot add the same private member more than once");member instanceof WeakSet?member.add(obj):member.set(obj,value)};var __privateSet=(obj,member,value,setter)=>{__accessCheck(obj,member,"write to private field");setter?setter.call(obj,value):member.set(obj,value);return value};var __privateMethod=(obj,member,method)=>{__accessCheck(obj,member,"access private method");return method};var _navData,_siteNavRootUrl,_navItems,_topLevelItems,_menuButton,_dialog,_navParentDiv,_crumbsUl,_rootMenuCrumb,_rootMenuButton,_childrenDiv,_sectionLinksDiv,_sectionLinksP,_sectionLinksUl,_returnDiv,_returnP,_returnButton,_currentItem,_initialItem,_initDialog,initDialog_fn,_show,show_fn,_hide,hide_fn,_updateDialog,updateDialog_fn,_reset,reset_fn,_isShowingRoot,isShowingRoot_fn,_showParent,showParent_fn,_showItem,showItem_fn,_loadNavData,loadNavData_fn,_getSiteNavRootItem,getSiteNavRootItem_fn;inz.nav2023={menu:null};inz.nav2023.init=function(){document.addEventListener("inz.navdata.loaded",e=>{inz.nav2023.menu=new HamburgerMenu(inz.navData.data,inz.navData.siteNavRoot)});document.body.style.setProperty("--inz-scrollbar-width",`${window.innerWidth-document.body.clientWidth}px`)};class HamburgerMenu{constructor(data,siteNavRootUrl){__privateAdd(this,_initDialog);__privateAdd(this,_show);__privateAdd(this,_hide);__privateAdd(this,_updateDialog);__privateAdd(this,_reset);__privateAdd(this,_isShowingRoot);__privateAdd(this,_showParent);__privateAdd(this,_showItem);__privateAdd(this,_loadNavData);__privateAdd(this,_getSiteNavRootItem);__privateAdd(this,_navData,void 0);__privateAdd(this,_siteNavRootUrl,void 0);__privateAdd(this,_navItems,void 0);__privateAdd(this,_topLevelItems,void 0);__privateAdd(this,_menuButton,void 0);__privateAdd(this,_dialog,void 0);__privateAdd(this,_navParentDiv,void 0);__privateAdd(this,_crumbsUl,void 0);__privateAdd(this,_rootMenuCrumb,void 0);__privateAdd(this,_rootMenuButton,void 0);__privateAdd(this,_childrenDiv,void 0);__privateAdd(this,_sectionLinksDiv,void 0);__privateAdd(this,_sectionLinksP,void 0);__privateAdd(this,_sectionLinksUl,void 0);__privateAdd(this,_returnDiv,void 0);__privateAdd(this,_returnP,void 0);__privateAdd(this,_returnButton,void 0);__privateAdd(this,_currentItem,void 0);__privateAdd(this,_initialItem,void 0);__privateSet(this,_navData,data);__privateSet(this,_siteNavRootUrl,siteNavRootUrl);__privateSet(this,_navItems,{});__privateSet(this,_topLevelItems,[]);__privateSet(this,_menuButton,document.getElementById("header_menu_2023"));if(__privateGet(this,_menuButton)){__privateGet(this,_menuButton).addEventListener("click",e=>{__privateMethod(this,_show,show_fn).call(this)})}__privateMethod(this,_initDialog,initDialog_fn).call(this);document.body.addEventListener("keydown",event=>{if(__privateGet(this,_dialog)&&event.key==="F2"&&!event.ctrlKey&&!event.altKey&&!event.shiftKey&&!event.metaKey){if(__privateGet(this,_dialog).open){__privateMethod(this,_hide,hide_fn).call(this)}else{__privateMethod(this,_show,show_fn).call(this)}event.stopPropagation();event.preventDefault()}});__privateMethod(this,_loadNavData,loadNavData_fn).call(this)}}_navData=new WeakMap;_siteNavRootUrl=new WeakMap;_navItems=new WeakMap;_topLevelItems=new WeakMap;_menuButton=new WeakMap;_dialog=new WeakMap;_navParentDiv=new WeakMap;_crumbsUl=new WeakMap;_rootMenuCrumb=new WeakMap;_rootMenuButton=new WeakMap;_childrenDiv=new WeakMap;_sectionLinksDiv=new WeakMap;_sectionLinksP=new WeakMap;_sectionLinksUl=new WeakMap;_returnDiv=new WeakMap;_returnP=new WeakMap;_returnButton=new WeakMap;_currentItem=new WeakMap;_initialItem=new WeakMap;_initDialog=new WeakSet;initDialog_fn=function(){if(!__privateGet(this,_dialog)){__privateSet(this,_dialog,document.createElement("dialog"));__privateGet(this,_dialog).setAttribute("id","hamburger_menu_2023");__privateGet(this,_dialog).innerHTML='<nav class="menu_body">\n    <div class="close_bar">\n        <button><span class="icon"></span><span>Close</span></button>\n    </div>\n    <div class="upper_nav">\n        <div class="nav_parent">\n            <button class="nav_button nav_parent" title="Up One Level"></button>\n        </div>\n        <ul class="crumbs">\n            <li class="root_menu"><button class="nav_item">Main menu</button></li>\n        </ul>\n    </div>\n    <div class="children"></div>\n    <div class="section_links">\n        <p></p>\n        <ul></ul>\n    </div>\n    <div class="return">\n        <p></p>\n        <button><span class="icon"></span> Return to main menu</button>\n    </div>\n</nav>';__privateSet(this,_navParentDiv,__privateGet(this,_dialog).querySelector("div.nav_parent"));__privateSet(this,_crumbsUl,__privateGet(this,_dialog).querySelector("ul.crumbs"));__privateSet(this,_rootMenuCrumb,__privateGet(this,_crumbsUl).querySelector("li.root_menu"));__privateSet(this,_rootMenuButton,__privateGet(this,_rootMenuCrumb).querySelector("button"));__privateGet(this,_rootMenuButton).addEventListener("click",()=>{__privateMethod(this,_showItem,showItem_fn).call(this,null)});__privateSet(this,_childrenDiv,__privateGet(this,_dialog).querySelector("div.children"));__privateSet(this,_sectionLinksDiv,__privateGet(this,_dialog).querySelector("div.section_links"));__privateSet(this,_sectionLinksP,__privateGet(this,_sectionLinksDiv).querySelector("p"));__privateSet(this,_sectionLinksUl,__privateGet(this,_sectionLinksDiv).querySelector("ul"));__privateSet(this,_returnDiv,__privateGet(this,_dialog).querySelector("div.return"));__privateSet(this,_returnP,__privateGet(this,_returnDiv).querySelector("p"));__privateSet(this,_returnButton,__privateGet(this,_returnDiv).querySelector("button"));__privateGet(this,_returnButton).addEventListener("click",()=>{__privateMethod(this,_showItem,showItem_fn).call(this,null)});__privateGet(this,_dialog).querySelector(".close_bar button").addEventListener("click",()=>{__privateMethod(this,_hide,hide_fn).call(this)});__privateGet(this,_navParentDiv).querySelector("button").addEventListener("click",()=>{__privateMethod(this,_showParent,showParent_fn).call(this)});document.body.append(__privateGet(this,_dialog))}};_show=new WeakSet;show_fn=function(){if(__privateGet(this,_dialog)&&!__privateGet(this,_dialog).open){__privateMethod(this,_reset,reset_fn).call(this);document.body.classList.add("lightbox_showing");__privateGet(this,_dialog).showModal()}};_hide=new WeakSet;hide_fn=function(){if(__privateGet(this,_dialog)&&__privateGet(this,_dialog).open){__privateGet(this,_dialog).close();document.body.classList.remove("lightbox_showing")}};_updateDialog=new WeakSet;updateDialog_fn=function(){const self=this;function makeItemButton(item){const button=document.createElement("button");button.setAttribute("class","nav_item");if(item===__privateGet(self,_currentItem)){button.setAttribute("disabled","")}button.textContent=item.title;button.addEventListener("click",()=>{var _a;__privateMethod(_a=self,_showItem,showItem_fn).call(_a,item)});return button}__privateGet(this,_dialog).querySelector("div.nav_parent").style.display=__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)?"none":"block";__privateGet(this,_crumbsUl).innerHTML="";__privateGet(this,_crumbsUl).append(__privateGet(this,_rootMenuCrumb));if(__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)){__privateGet(this,_rootMenuButton).setAttribute("disabled","")}else{__privateGet(this,_rootMenuButton).removeAttribute("disabled")}if(!__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)){for(const item of __privateGet(this,_currentItem).getAncestors()){let li2=document.createElement("li");li2.append(makeItemButton(item));__privateGet(this,_crumbsUl).append(li2)}let li=document.createElement("li");li.append(makeItemButton(__privateGet(this,_currentItem)));__privateGet(this,_crumbsUl).append(li)}function makeItemLink(item){const a=document.createElement("a");a.setAttribute("href",item.url);if(item.isCurrentPage()){a.classList.add("current_page")}a.textContent=item.title;return a}function makeChildrenButton(item){const button=document.createElement("button");button.setAttribute("class","nav_button nav_children");button.setAttribute("title",`${item.title}: Show More`);button.addEventListener("click",()=>{var _a;__privateMethod(_a=self,_showItem,showItem_fn).call(_a,item)});return button}__privateGet(this,_childrenDiv).innerHTML="";let children;if(__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)){children=[__privateMethod(this,_getSiteNavRootItem,getSiteNavRootItem_fn).call(this)].concat(__privateGet(this,_topLevelItems))}else{children=__privateGet(this,_currentItem).children}if(children){const ul=document.createElement("ul");for(const child of children){const li=document.createElement("li");li.append(makeItemLink(child));if(child.hasChildren()){const div=document.createElement("div");div.append(makeChildrenButton(child));li.append(div)}ul.append(li)}__privateGet(this,_childrenDiv).append(ul)}const topLevelNavItem=__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)?null:__privateGet(this,_currentItem).getTopLevelNavItem();const hasUtilityLinks=topLevelNavItem instanceof TopLevelNavItem&&topLevelNavItem.utilityLinks instanceof Array&&topLevelNavItem.utilityLinks.length>0;__privateGet(this,_sectionLinksDiv).style.display=hasUtilityLinks?"block":"none";if(hasUtilityLinks){__privateGet(this,_sectionLinksP).textContent=`Featured pages in ${topLevelNavItem.title}:`;__privateGet(this,_sectionLinksUl).innerHTML="";for(const link of topLevelNavItem.utilityLinks){let li=document.createElement("li");let a=document.createElement("a");a.setAttribute("href",link.url);a.textContent=link.title;li.append(a);__privateGet(this,_sectionLinksUl).append(li)}}if(topLevelNavItem instanceof TopLevelNavItem){__privateGet(this,_returnP).textContent=`Not looking for information on ${topLevelNavItem.title}?`;__privateGet(this,_returnDiv).style.display="block"}else{__privateGet(this,_returnDiv).style.display="none"}};_reset=new WeakSet;reset_fn=function(){__privateSet(this,_currentItem,__privateGet(this,_initialItem));__privateMethod(this,_updateDialog,updateDialog_fn).call(this)};_isShowingRoot=new WeakSet;isShowingRoot_fn=function(){return __privateGet(this,_currentItem)===null};_showParent=new WeakSet;showParent_fn=function(){if(!__privateMethod(this,_isShowingRoot,isShowingRoot_fn).call(this)){__privateSet(this,_currentItem,__privateGet(this,_currentItem).hasParent()?__privateGet(this,_currentItem).parent:null);__privateMethod(this,_updateDialog,updateDialog_fn).call(this)}};_showItem=new WeakSet;showItem_fn=function(item){__privateSet(this,_currentItem,item);__privateMethod(this,_updateDialog,updateDialog_fn).call(this)};_loadNavData=new WeakSet;loadNavData_fn=function(){const self=this;function parseChild(o,parent){let item=new NavItem(o.i,o.u,o.t,[],parent);__privateGet(self,_navItems)[item.uid]=item;if(__privateGet(self,_initialItem)===void 0&&item.isCurrentPage()){__privateSet(self,_initialItem,item)}if(o.c){for(const c of o.c){item.children.push(parseChild(c,item))}}return item}__privateGet(this,_topLevelItems).length=0;for(const o of __privateGet(this,_navData)){let item=new TopLevelNavItem(o.i,o.u,o.t,[],[],o.m,o.s);__privateGet(this,_navItems)[item.uid]=item;__privateGet(this,_topLevelItems).push(item);if(__privateGet(this,_initialItem)===void 0&&item.isCurrentPage()){__privateSet(this,_initialItem,item)}if(o.l){for(const l of o.l){item.utilityLinks.push(new NavLinkItem(l.i,l.u,l.t,l.a))}}if(o.c){for(const c of o.c){item.children.push(parseChild(c,item))}}}if(__privateGet(this,_initialItem)===void 0){__privateSet(this,_initialItem,null)}else{__privateSet(this,_initialItem,__privateGet(this,_initialItem).hasParent()?__privateGet(this,_initialItem).parent:null)}};_getSiteNavRootItem=new WeakSet;getSiteNavRootItem_fn=function(){return new NavItem(null,__privateGet(this,_siteNavRootUrl),"Home",void 0,void 0)};class NavItem{constructor(uid,url,title,children,parent){this.uid=uid;this.url=url;this.title=title;this.children=children;this.parent=parent}hasChildren(){return typeof this.children==="object"&&this.children.length>0}hasParent(){return typeof this.parent==="object"}getAncestors(){let ancestors=[];for(let i=this;i.hasParent();i=i.parent){ancestors.push(i.parent)}ancestors.reverse();return ancestors}getTopLevelNavItem(){for(let i=this;;i=i.parent){if(i instanceof TopLevelNavItem){return i}if(!i.hasParent()){break}}return null}isCurrentPage(){return new RegExp("^"+this.url+"[/]?$").exec(window.location.pathname)!==null}}class NavLinkItem{constructor(uid,url,title,adminUrl){this.uid=uid;this.url=url;this.title=title;this.adminUrl=adminUrl}}class TopLevelNavItem extends NavItem{constructor(uid,url,title,utilityLinks,children,menuTheme,isSection){super(uid,url,title,children);this.utilityLinks=utilityLinks;this.menuTheme=menuTheme;this.isSection=isSection}}console.debug("inz.nav2023 loaded");


inz.Lightbox=function(lightboxSelector,triggerSelector,initialFocusSelector,shouldShowLightboxCheck){this.lightbox=$(lightboxSelector);this.displayValue=this.lightbox.data("display");this.initialFocusSelector=initialFocusSelector;this.previousFocusElement=null;this.shouldShowLightboxCheck=typeof shouldShowLightboxCheck==="function"?shouldShowLightboxCheck:function(lightbox){return true};var self=this;$(triggerSelector).click(function(){self.show()});this.lightbox.find(".close_lightbox").click(function(){self.hide()});this.lightbox.data("lightbox",this)};inz.Lightbox.prototype.show=function(){if(!this.shouldShowLightboxCheck(this)){console.log("lightbox show() vetoed!");return}this.previousFocusElement=$(document.activeElement);this.lightbox.trigger("inz_lightbox:showing");if(this.displayValue){this.lightbox.css("display",this.displayValue)}else{this.lightbox.show()}$(document.body).addClass("lightbox_showing");var initialFocusElement=this.initialFocusSelector?this.lightbox.find(this.initialFocusSelector).first():null;if(!initialFocusElement){initialFocusElement=inz.getFocusable(this.lightbox.find(".lightbox_body")).first()}if(initialFocusElement.length>0){initialFocusElement[0].focus()}else{this.lightbox.focus()}this.lightbox.trigger("inz_lightbox:shown")};inz.Lightbox.prototype.hide=function(){this.lightbox_hide_vetoed=false;this.lightbox.trigger("inz_lightbox:hiding",[this]);if(this.lightbox_hide_vetoed){return}this.lightbox.hide();this.afterHide()};inz.Lightbox.prototype.afterHide=function(){$(document.body).toggleClass("lightbox_showing",$(".inz_lightbox").is(":visible"));if(this.previousFocusElement){this.previousFocusElement.focus()}this.lightbox.trigger("inz_lightbox:hidden")};inz.header={};inz.header.init=function(){$(".inz_lightbox").keydown(function(e){if(e.keyCode===9){e.preventDefault();var focusableElements=inz.getFocusable(this);if(focusableElements.length===0){return}var newIndex=focusableElements.index(e.target)+(e.shiftKey?-1:1);if(newIndex<0){newIndex=focusableElements.length-1}else if(newIndex>=focusableElements.length){newIndex=0}focusableElements[newIndex].focus()}});var searchLightbox=new inz.Lightbox("#header_search_lightbox",".header2019 #header_search");searchLightbox.lightbox.on("inz_lightbox:showing",function(e){searchLightbox.lightbox.find(".lightbox_body > input").val(null)});var loginLightbox=new inz.Lightbox("#header_login_lightbox",".header2019 #header_login");function resetLoginLightbox(){$("#header_login_lightbox .login_details").hide();$("#header_login_lightbox .service_selector.selected").each(function(){inz.forms.panel.getLoginForm($(this).attr("data-target-id").substring(1)).reset();$(this).removeClass("selected")});$("#header_login_lightbox article.service_detail").hide()}loginLightbox.lightbox.on("inz_lightbox:showing",resetLoginLightbox);document.addEventListener(inz.forms.panel.events.PANEL_SHOWN,function(e){if(e.detail.container.offsetParent!==null){var loginDetails=$("#header_login_lightbox .login_details");$("html, body").animate({scrollTop:loginDetails.offset().top})}});var lightboxSearchInput=$("#header_search_lightbox > .lightbox_body input");var lightboxSearchButton=$("#header_search_lightbox > .lightbox_body button");function performLightboxSearch(){var a=lightboxSearchInput.val();if(a)inz.siteSearchWidget.submitQuery(a);if(/^\/(inz\/)?search$/.test(window.location.pathname)){searchLightbox.hide()}}lightboxSearchButton.click(performLightboxSearch);lightboxSearchInput.keydown(function(e){var swallowEvent=false;switch(e.which){case 13:performLightboxSearch();swallowEvent=true;break;case 27:if($(this).val()){$(this).val(null)}else{searchLightbox.hide()}swallowEvent=true;break}if(swallowEvent){e.preventDefault();e.stopPropagation()}});function updateLightboxSearchButton(){lightboxSearchButton.prop("disabled",!lightboxSearchInput.val())}lightboxSearchInput.keyup(updateLightboxSearchButton);updateLightboxSearchButton();$("#header_login_lightbox .service_selector").click(function(){var targetWasSelected=$(this).hasClass("selected");resetLoginLightbox();if(!targetWasSelected){$($(this).attr("data-target-id")).show();var loginDetails=$("#header_login_lightbox .login_details");loginDetails.show();$("html, body").animate({scrollTop:loginDetails.offset().top});$(this).addClass("selected")}});var menuLightbox=new inz.Lightbox("#header_menu_lightbox",".header2019 #header_menu","button.close_lightbox")};


inz.footer={};inz.footer.init=function(){var widget=$("#footer_visa_search_widget");if(!widget.length){return}widget.on("select2:select",function(e){window.location=$(e.target).select2("data")[0]["id"]})};


inz.genericContent={};inz.genericContent.init=function(){document.addEventListener(inz.viewport.EVENT_INZ_ADJUST_LAYOUT,()=>{inz.genericContent.updateFullWidthImages()})};inz.genericContent.updateFullWidthImages=function(){let extendToLeftEdge=!inz.viewport.isTabletOrSmaller();let nl=document.querySelectorAll(".inz_main_column .inz_image.inz_image_full_width");for(let n of nl){if(extendToLeftEdge){n.style.marginLeft=0-n.parentElement.offsetLeft-n.offsetParent.offsetLeft+"px"}else{n.style.marginLeft=null}}};


var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};inz=inz||{};inz.details=inz.details||{};inz.details.bpStateMobile=false;inz.details.bpStateTablet=false;inz.details.init=function(){const mat=window.matchMedia("(max-width: 944px)");mat.addEventListener("change",inz.details.bpTablet);const mbl=window.matchMedia("(max-width: 749px)");mbl.addEventListener("change",inz.details.bpMobile);inz.details.bpTablet(mat);inz.details.bpMobile(mbl);$(".vd_nb_apply_btn input").on("click",function(e){e.preventDefault();e.stopPropagation()});inz.details.loginLightbox=new inz.Lightbox("#details_login_lightbox",".vd_nb_apply_btn input");inz.details.hashChangeHandler();window.addEventListener("hashchange",inz.details.hashChangeHandler,false)};inz.details.hashChangeHandler=function(e){if(window.location.hash.length>1){let sec=window.location.hash.substring(1);let sid;switch(sec){case"overview":sid="#overview";break;case"apply":sid=`#sc_${inz.details.findSectionByType("who_can_apply")}`;break;case"process":sid=`#sc_${inz.details.findSectionByType("process_and_costs")}`;break;case"submit":sid=`#sc_${inz.details.findSectionByType("how_to_submit")}`;break;case"points":sid=`#sc_${inz.details.findSectionByType("points")}`;break;case"conditions":sid=`#sc_${inz.details.findSectionByType("conditions")}`;break;default:if(sec.startsWith("sc_"))sid="#"+sec;break}if(sid!==null){let target=$(sid);if(target.length!==0){window.scrollTo({left:0,top:target.offset().top-$(".vd_navbar").outerHeight()+10,behavior:"smooth"});setTimeout(function(){window.scrollTo({left:0,top:target.offset().top-$(".vd_navbar").outerHeight()+10,behavior:"smooth"})},500)}}}};inz.details.findSectionByType=function(section_type){let sections=document.querySelectorAll(".vd_section_container");for(let section of sections){let vds=section.getAttribute("data-vds-type");if(vds===section_type){return section.getAttribute("data-sid")}}return null};inz.details.bpTablet=function(e){if(e.matches){inz.details.bpStateTablet=true}else{inz.details.bpStateTablet=false}inz.details.breakpointChange(true,false)};inz.details.bpMobile=function(e){if(e.matches){inz.details.bpStateMobile=true}else{inz.details.bpStateMobile=false}inz.details.breakpointChange(false,true)};inz.details.breakpointChange=function(tablet,mobile){console.debug(`breakpoingChange: ${tablet}, ${mobile} - bpTable: ${inz.details.bpStateTablet} bpMobile: ${inz.details.bpStateMobile}`);if(tablet){if(inz.details.bpStateTablet){inz.accordion.attachEvents($(".vd_submit"))}else{inz.accordion.openAll($(".vd_submit section article .inz_accordion"),true);$(".vd_submit section article .process_title").off("click")}}if(mobile){if(inz.details.bpStateMobile){let apply=$("#vd_navbar .vd_nb_nav_tab_container > .vd_nb_apply_btn");if(apply.length===1){apply.detach().appendTo("#vd_navbar .vd_nb_nav_tab_backing")}}else{let apply=$("#vd_navbar .vd_nb_nav_tab_backing > .vd_nb_apply_btn");if(apply.length===1){apply.detach().appendTo("#vd_navbar .vd_nb_nav_tab_container")}}}};inz.details.dispatchEvent=function(srcElement,eventName,detail){let event=new CustomEvent(eventName,{bubbles:true,detail});srcElement.dispatchEvent(event)};$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||"")}else{o[this.name]=this.value||""}});return o};inz.details.criteria={};inz.details.criteria.emptyTipsCheck=function(){$(".vd_criteria .inz_criteria_tips").each(function(){let last_tip=$(this).find(".inz_criteria_tip").not(".inactive").last();if(last_tip.length===0){$(this).addClass("hidden")}else{$(this).removeClass("hidden");last_tip.addClass("tip_last_vis")}})};inz.details.initSections=function(){let sections=document.querySelectorAll("#main > .vd_section_container");sections.forEach(function(section){let sid=section.getAttribute("data-sid");inz.details.sectionLoaded(sid)})};inz.details.sectionLoaded=function(sec_id){let sec=$(`#sc_${sec_id}`).first();let sec_type=$(sec).attr("data-vds-type");switch(sec_type){case"folder":{let vd_sec=$(sec).find(".vd_section").first();vd_sec.find(".vd_section").each(function(){inz.details.sectionLoaded($(this).attr("id"))});break}case"how_to_submit":inz.details.breakpointChange(true,false);break;case"process_and_costs":if(inz.details.navbar&&inz.details.navbar.$filters){let nat=inz.details.navbar.$filters.find("#filter_nationality").val();let res=inz.details.navbar.$filters.find("#filter_residence").val();$("#"+sec_id+" .process_documents .pdoc").each(function(){let filters=$(this).find("[data-showonfilter]");if(filters.length!==0){filters.each(function(){let vals=$(this).data("showonfilter").split(",");for(let val of vals){val=val.trim();if(val.startsWith("residence-")&&val.substr(val.length-3)===res||val.startsWith("nationality-")&&val.substr(val.length-3)===nat){$(this).toggleClass("inactive",false);break}}})}})}$("#"+sec_id+" .vd_currency_select").on("change",function(e){let currency=$(this).val();$(this).closest(".vd_currency_group").find(".currency").hide();$(this).closest(".vd_currency_group").find(`[data-currency="${currency}"]`).show()});$("#"+sec_id+" .vd_currency_select").trigger("change");break;case"points":$(".vd_navbar .vd_nb_points").toggleClass("hidden",false);window.insertTerms();break;case"conditions":break;case"who_can_apply":$(".vd_criteria_view_all").click(function(){let container=$(this).closest(".vd_criteria");if($(this).data("open")){inz.accordion.closeAll(container.find(".inz_accordion"));$(this).text("View All Evidence");$(this).data("open",false)}else{inz.accordion.openAll(container.find(".inz_accordion"));$(this).text("Hide All Evidence");$(this).data("open",true)}});inz.details.navbar.$navbar[0].addEventListener("inz:navbar_filters",function(e){console.debug("@@@ Navbar filter event: "+JSON.stringify(e.detail));$(".vd_criteria [data-flt-nat]").each(function(){if($(this).data("flt-nat").includes(e.detail.nat)){$(this).removeClass("inactive")}else{$(this).addClass("inactive")}});$(".vd_criteria [data-flt-res]").each(function(){if($(this).data("flt-res").includes(e.detail.res)){$(this).removeClass("inactive")}else{$(this).addClass("inactive")}});inz.details.criteria.emptyTipsCheck()});inz.details.criteria.emptyTipsCheck();break}};inz.details.createNavbar=function(navbarEl){inz.details.navbar=new inz.details.Navbar(navbarEl,true);inz.details.navbar.setup();return inz.details.navbar};inz.details.createFilterNavbar=function(navbarEl,filterEl,filters,firstId){inz.details.navbar=new inz.details.FilterNavbar(navbarEl,true,filterEl,filters,firstId);inz.details.navbar.setup();return inz.details.navbar};inz.details.createSeparateNavbar=function(navbarEl){inz.details.navbar=new inz.details.SeparateNavbar(navbarEl,false);inz.details.navbar.setup();return inz.details.navbar};inz.details.getNavbar=function(navbarEl){let navbar=$(navbarEl).data("navbar");return navbar};inz.details.Navbar=class{constructor(navbarEl,overviewTab){__publicField(this,"clearSections",function(){for(let idx in inz.details.sectionOrder){let sectionId=inz.details.sectionOrder[idx];inz.details.sections[sectionId]=false}});let _this=this;this.$navbar=$(navbarEl);this.$navbar.data("navbar",this);this.navbar=this.$navbar[0];this.navbarState=0;this.navbarStuck=false;this.scrollTarget=null;this.hasFilters=false;this.sectionOrder=[];this.sections={};this.sectionElements={};this.navbarStickyIO=new IntersectionObserver(function(entries,observer){_this.handleNavbarIntersect(entries,observer)},{threshold:[0]});this.navbarStickyIO.observe(document.querySelector(".navbar_marker"));this.navbarSectionIO=new IntersectionObserver(function(entries,observer){_this.handleNavbarSectionIntersect(entries,observer)},{threshold:[0],rootMargin:"-220px 0px 0px 0px"});if(overviewTab)this.navbarSectionOvr=new IntersectionObserver(function(entries,observer){_this.handleNavbarSectionIntersect(entries,observer)},{threshold:[0],rootMargin:"-10px 0px 0px 0px"});let sections=document.querySelectorAll("#main > .vd_section_container");let idx=0;this.sectionElements["overview"]=document.getElementById("overview");this.sectionElements["overview"].setAttribute("data-vds-type","overview");this.sectionElements["overview"].setAttribute("data-sid","overview");if(overviewTab)this.navbarSectionOvr.observe(this.sectionElements["overview"]);this.sections["overview"]=false;this.sectionOrder[idx++]="overview";sections.forEach(function(section){let sid=section.getAttribute("data-sid");let vds=section.getAttribute("data-vds-type");_this.sectionOrder[idx++]=sid;_this.sections[sid]=false;_this.sectionElements[sid]=section;_this.navbarSectionIO.observe(section)})}setup(){this.setupNavbar(false);this.setupHandlers()}scrollNavbarForTab(tab_el){if(tab_el===void 0){return}let cr=tab_el.getBoundingClientRect();let container_cr=$(".vd_navbar .vd_nb_nav_tabs")[0].getBoundingClientRect();let centre_x=container_cr.width/2;let left=tab_el.offsetLeft-centre_x+cr.width/2;if(left<0)left=0;$(".vd_navbar .vd_nb_nav_tabs")[0].scroll({top:0,left,behavior:"smooth"})}setupHandlers(){let _this=this;$(".vd_navbar .vd_nb_nav_tabs_tab").click(function(e){_this.scrollNavbarForTab(this);let target=$($(this).find("a").attr("href"));window.scrollTo({left:0,top:target.offset().top-$(".vd_navbar").outerHeight()+10,behavior:"smooth"});setTimeout(function(){window.scrollTo({left:0,top:target.offset().top-$(".vd_navbar").outerHeight()+10,behavior:"smooth"})},500);e.preventDefault();e.stopPropagation()})}setupNavbar(hasFilters){let config={attributes:true,childList:false,subtree:false};let _this=this;_this.$navbar.on("affixed.bs.affix",function(){$(".navbar_filler").css("height","200px");$(".navbar_filler").removeClass("hidden");if(hasFilters){_this.$navbar.find(".vd_nb_title").show();_this.openCloseFilters(false)}_this.navbarStuck=true});_this.$navbar.on("affixed-top.bs.affix",function(){$(".navbar_filler").addClass("hidden");if(hasFilters){_this.$navbar.find(".vd_nb_title").hide()}_this.navbarStuck=false});$(_this.$navbar.find(".vd_nb_tab a").on("click",function(){var $acc=$(_this.$navbar.find(".vd_nb_tab a"));if(hasFilters){let isOpen=$acc.hasClass("active");if(isOpen){setTimeout(function(){var isOpen2=$acc.hasClass("active");if(isOpen2)$("#navbar_filters").css({"display":"","height":"auto"})},333)}}}))}dispatchNavbarEvent(eventName,detail){let event=new CustomEvent(eventName,{bubbles:true,detail});this.navbar.dispatchEvent(event)}stickNavbar(){$(".navbar_filler").css("height","200px");$(".navbar_filler").removeClass("hidden");$("#vd_navbar").toggleClass("affix",true);$("#vd_navbar").toggleClass("affix-top",false);this.navbarStuck=true}unstickNavbar(){$(".navbar_filler").addClass("hidden");$("#vd_navbar").toggleClass("affix",false);$("#vd_navbar").toggleClass("affix-top",true);this.navbarStuck=false}handleNavbarIntersect(entries,observer){let entry=entries[0];if(entry.isVisible||entry.boundingClientRect.top>=0){this.unstickNavbar();if(this.navbarStuck){this.navbarStuck=false;this.dispatchNavbarEvent("inz:navbar_state",{isStuck:false})}}else if(entry.boundingClientRect.top<0){this.stickNavbar();if(!this.navbarStuck){this.navbarStuck=true;this.dispatchNavbarEvent("inz:navbar_state",{isStuck:true})}}}handleNavbarSectionIntersect(entries,observer){for(let idx in entries){let entry=entries[idx];let sectionType=entry.target.getAttribute("data-vds-type");let sectionId=entry.target.getAttribute("data-sid");console.debug(entry.time+" - T: "+sectionType+" In: "+entry.isIntersecting+" Vis: "+entry.isVisible+" Ratio: "+entry.intersectionRatio+" Top: "+entry.boundingClientRect.top);this.sections[sectionId]=entry.isIntersecting}for(let idx in this.sectionOrder){let sectionId=this.sectionOrder[idx];if(this.sections[sectionId]){console.debug("ID: "+sectionId);$(".vd_nb_nav_tabs_tab").removeClass("current");let tgt=$('.vd_nb_nav_tabs_tab[data-sid="'+sectionId+'"]');tgt.addClass("current");this.scrollNavbarForTab(tgt[0]);break}}}};inz.details.FilterNavbar=class extends inz.details.Navbar{constructor(navbarEl,overviewTab,filterEl,filters,firstId){super(navbarEl,overviewTab);let _this=this;this.$filters=$(filterEl);this.$submit=$(filterEl).find('input[type="submit"]');this.filters=filters;this.hasFilters=true;let firstFilter=this.filters[firstId];this.addFilter(this.$filters,firstFilter,3);this.fitFilters()}setup(){this.setupHandlers();this.setupNavbar(true)}setupHandlers(){let _this=this;super.setupHandlers();this.$filters.find(".vd_nb_filter_input select").on("select2:select",function(){_this.submitEnable()});this.$filters.on("submit",function(e){e.preventDefault();_this.filterUpdate();_this.openCloseFilters(false)});$("#navbar_filters").css({"display":"","height":"auto"});setTimeout(function(){$("#navbar_filters").css({"display":"","height":"auto"});_this.navbarChange()},333)}openCloseFilters(open){let $acc=$(this.$navbar.find(".vd_nb_tab a"));let isOpen=$acc.hasClass("active");if(open&&!isOpen){$acc.trigger("click");$acc.addClass("active");setTimeout(function(){$("#navbar_filters").css({"display":"","height":"auto"})},333)}else if(!open&&isOpen){$acc.trigger("click");$acc.removeClass("active")}}fitFilters(){let $filters=$(inz.details.$filters).find(".vd_nb_filter_input");let numFilters=$filters.length;if(numFilters<4){$filters.each(function(){$(this).removeClass("vd_nb_filter_wide")})}else{if(numFilters===4){$($filters[0]).addClass("vd_nb_filter_wide");$($filters[1]).addClass("vd_nb_filter_wide")}else{$filters.each(function(){$(this).removeClass("vd_nb_filter_wide")})}}}focusFilters(event){event.preventDefault();this.openCloseFilters(true)}submitEnable(){let missingValue=false;this.$filters.find(".vd_nb_filter_input select").each(function(){if($(this).val()==="")missingValue=true});if(missingValue){this.$submit.prop("disabled",true)}else{this.$submit.prop("disabled",false)}return!missingValue}readFilters(){let values=sessionStorage.getItem("inz.details.filters")}storeFilters(){let values=inz.details.$filters.serialize();sessionStorage.setItem("inz.details.filters",values)}filterUpdate(){$.ajaxSetup({cache:true});let _this=this;let values=this.$filters.serialize();let url=window.location.origin+window.location.pathname;$("div.vd_section[data-details-fu]").each(function(){let sec=$(this).attr("data-details-fu");let sec_id=$(this).attr("id");let sec_type=$("#sc_"+sec_id).data("vds-type");console.debug(`Filter update: Sec: ${sec} ${this} (${sec_type})`);$(this).parents(".vd_background").first().load(url+"?sec="+sec+"&"+values,function(response,status,xhr){if(status==="error"){let msg="Sorry but there was an error: ";console.log(msg+xhr.status+" "+xhr.statusText)}else if(status==="success"){$(document).trigger("ajaxpages:contentloaded",{target:$("#"+sec_id)});inz.details.sectionLoaded(sec_id)}})});this.dispatchNavbarEvent("inz:navbar_filters",this.$filters.serializeObject())}shouldAddFilter(filter){let count=0;let citizenship=this.$filters.find("#filter_nationality").val();for(let opt of filter.options){if(opt.citizenship===void 0||opt.citizenship===null){count+=1}else{if(opt.citizenship.includes(citizenship)===true)count+=1}}return count>1}addFilter(el,filter,insertLocation){let _this=this;let filterHtml='<div class="vd_nb_filter_input"><select id="'+filter.id+'" name="'+filter.name+'" class="" data-placeholder="'+filter.placeholder+'" data-theme="light" class="select_2-generic" style="width: 100%">        <option></option>        <option value=" " disabled="disabled">'+filter.placeholder+"</option>";for(let i=0;i<filter.options.length;i++){if(filter.options[i].next)filterHtml+=`<option data-fltn="${filter.options[i].next}" value="${filter.options[i].value}">${filter.options[i].name}</option>`;else filterHtml+=`<option value="${filter.options[i].value}">${filter.options[i].name}</option>`}filterHtml+="</select></div>";if(el!==void 0){switch(insertLocation){case 0:$(filterHtml).insertAfter(el);break;case 1:$(filterHtml).insertBefore(el);break;case 2:$(filterHtml).appendTo(el);break;case 3:$(filterHtml).prependTo(el);break}}else $("form#filters").append(filterHtml);if(filter.options.length<10)$("#"+filter.id).select2({theme:"light","placeholder":filter.placeholder,"minimumResultsForSearch":"Infinity"});else $("#"+filter.id).select2({theme:"light","placeholder":filter.placeholder});$("#"+filter.id).on("select2:select",function(){let opt=$(this).children("option:selected");let next=opt.attr("data-fltn");if(next!==void 0){$(this).parent().nextAll(".vd_nb_filter_input").remove();let flt=_this.filters[next];if(_this.shouldAddFilter(flt)){_this.addFilter($(this).parent(),flt,0);_this.fitFilters()}else{_this.submitEnable()}}else _this.submitEnable()})}navbarChange(){console.debug("Navbar Change: "+this.$navbar.attr("class")+" State: "+this.navbarState);if(this.$navbar.hasClass("affix")){this.navbarStuck=true;let orgHgt=this.$navbar.height();this.$navbar.find(".vd_nb_title").show();this.openCloseFilters(false);let hgtChange=this.$navbar.height()-orgHgt-1}else{if(this.navbarState===1){this.navbarState=0;return}this.navbarStuck=false;this.$navbar.find(".vd_nb_title").hide()}}};inz.details.checkCurrentSection=function(){var topOfView=$(".vd_navbar").outerHeight();var sections=$(".vd_section");if(sections.length!=0){if(inz.details.hasFilters&&sections.length>1&&topOfView<=sections[1].getBoundingClientRect().top){$(".vd_nb_nav_tabs_tab").removeClass("current");$('.vd_nb_nav_tabs_tab a[href="#overview"]').parent().addClass("current");return}for(var n=0;n<sections.length;n++){if(sections[n].getBoundingClientRect().bottom>=topOfView){$(".vd_nb_nav_tabs_tab").removeClass("current");$('.vd_nb_nav_tabs_tab a[href="#sc_'+sections[n].id+'"]').parent().addClass("current");break}}}};inz.details.SeparateNavbar=class extends inz.details.Navbar{constructor(navbarEl,overviewTab){super(navbarEl,overviewTab);let _this=this;let sections=document.querySelectorAll("#main > .vd_section_container");this.current="overview";let idx=0;sections.forEach(function(section){let sid=section.getAttribute("data-sid");let vds=section.getAttribute("data-vds-type");if(vds!=="overview"){$(section).hide()}});let ov=document.getElementById("overview");ov.setAttribute("data-sid",this.sectionOrder[1])}setup(){this.setupHandlers();this.setupNavbar(false)}setupHandlers(){let _this=this;super.setupHandlers();$(".vd_navbar .vd_nb_nav_tabs_tab a").click(function(e){e.preventDefault()});$(".vd_navbar .vd_nb_nav_tabs_tab").unbind("click");$(".vd_navbar .vd_nb_nav_tabs_tab").click(function(e){let sid=$(this).closest(".vd_nb_nav_tabs_tab").attr("data-sid");if(sid!==_this.current)_this.changeTab(sid)});this.current=this.sectionOrder[1];this.sectionElements[this.current].style.display="block"}changeTab(sid){this.sectionElements[sid].style.display="block";if(this.current!=="overview"){this.sectionElements[this.current].style.display="none"}this.current=sid;window.location.hash=this.current==="overview"?"#overview":`#sc_${sid}`}};


var inz=inz||{};inz.landing={};inz.landing.carousel={};inz.landing.carousel.init=function(){var c=inz.landing.carousel;c.container=$(".inz_landing_panel .inz_carousel_container").first()[0];c.left=$(".inz_landing_panel .inz_left_chevron");c.right=$(".inz_landing_panel .inz_right_chevron");c.slideWidth=$(".inz_landing_panel .inz_carousel_container .inz_carousel_slide").first().width();c.slides=$(".inz_landing_panel .inz_carousel_container .inz_carousel_slide");c.numberSlides=c.slides.length;c.curSlide=0;c.mediaQueryList=window.matchMedia("(max-width: 944px)");inz.landing.carousel.update_media();c.mediaQueryList.addEventListener("change",inz.landing.carousel.update_media);$(".inz_landing_panel .inz_left_chevron").hide();if(c.numberSlides==0)$(".inz_landing_panel .inz_right_chevron").hide();console.log("Carousel things: Slide width: "+c.slideWidth);$(".inz_landing_panel .inz_right_chevron").click(function(){console.debug("Right: "+c.container.scrollLeft+" Cur slide: "+c.curSlide);c.set_slide(c.curSlide+1)});$(".inz_landing_panel .inz_left_chevron").click(function(){console.debug("Left: "+c.container.scrollLeft+" Cur slide: "+c.curSlide);c.set_slide(c.curSlide-1)});$(".inz_landing_panel .inz_carousel_select").click(function(){var $this=$(this);console.debug("Id: "+$this.attr("id")+" Idx:"+$this.data("slide-idx"));var idx=$this.data("slide-idx");c.set_slide(idx)});c.set_slide(0)};inz.landing.carousel.set_display=function(el,visible){if(visible){if(!el.is(":visible"))el.fadeIn()}else{if(el.is(":visible"))el.fadeOut()}};inz.landing.carousel.set_slide=function(slide_idx){var c=inz.landing.carousel;if(slide_idx>c.numberSlides||slide_idx<0)return;c.slideWidth=$(".inz_landing_panel .inz_carousel_container .inz_carousel_slide").first().width();c.container.scrollTo({left:c.slideWidth*slide_idx,top:0,behavior:"smooth"});$(c.slides[c.curSlide]).fadeTo(500,.3);$("#slide_select_"+c.curSlide).fadeTo(500,.4);c.curSlide=slide_idx;$(c.slides[c.curSlide]).fadeTo(500,1);if(c.curSlide==0){c.set_display(c.right,true);c.set_display(c.left,false)}else if(c.curSlide==c.numberSlides-1){c.set_display(c.right,false);c.set_display(c.left,true)}else{c.set_display(c.right,true);c.set_display(c.left,true)}$("#slide_select_"+c.curSlide).fadeTo(500,1)};inz.landing.carousel.update_media=function(mql){console.log("Carousel Media!!!");var m=window.matchMedia("(max-width: 944px)");if(m.matches){$(".inz_carousel_image_small").show();$(".inz_carousel_image").hide();$(".inz_carousel_chevron").addClass("inz_small")}else{$(".inz_carousel_image").show();$(".inz_carousel_image_small").hide();$(".inz_carousel_chevron").removeClass("inz_small")}};


var inz=inz||{};inz.advancedImages=inz.advancedImages||{};inz.advancedImages.defaultSelector=".advanced_image_background";inz.advancedImages.resizeObserver=null;inz.advancedImages.init=function(){if(typeof window.ResizeObserver==="function"){inz.advancedImages.resizeObserver=new ResizeObserver(inz.advancedImages.resizeObserved)}inz.advancedImages.updateFocusPoint(inz.advancedImages.defaultSelector)};inz.advancedImages.resizeObserved=function(entries,observer){for(var n=0;n<entries.length;n++){inz.advancedImages.updateFocusPoint(entries[n].target,true)}};inz.advancedImages.setFocusPoint=function(target,focus_x,focus_y,img_width,img_height){var $el=$(target);var width=$el[0].clientWidth;var hgt=$el[0].clientHeight;var ratio=Math.max(width/img_width,hgt/img_height);width=Math.round(ratio*img_width);hgt=Math.round(ratio*img_height);var width_ratio=width/$el[0].clientWidth+1e-6;var height_ratio=hgt/$el[0].clientHeight+1e-6;var x=((focus_x/100-.5)*width_ratio/(width_ratio-1)+.5)*100;x=x>100?100:x<0?0:x;var y=((focus_y/100-.5)*height_ratio/(height_ratio-1)+.5)*100;y=y>100?100:y<0?0:y;$el.css({"background-position":""+x+"% "+y+"%"})};inz.advancedImages.calcFocusValues=function(img_el,client_x,client_y){var br=img_el.getBoundingClientRect();var x=Math.round(client_x-br.left);var y=Math.round(client_y-br.top);var focus_x=Math.round(x/img_el.clientWidth*100*100)/100;var focus_y=Math.round(y/img_el.clientHeight*100*100)/100;return[focus_x,focus_y,x,y]};inz.advancedImages.updateFocusPoint=function(target,skipResizeObserverRegistration){skipResizeObserverRegistration=skipResizeObserverRegistration===true;var elements=$(target);var focussed=0;for(var n=0;n<elements.length;n++){var e=$(elements[n]);if(e.hasClass(inz.advancedImages.defaultSelector.substring(1))){inz.advancedImages.setFocusPoint(e,e.data("focusX"),e.data("focusY"),e.data("imgXx"),e.data("imgYy"));if(!skipResizeObserverRegistration&&inz.advancedImages.resizeObserver!==null){inz.advancedImages.resizeObserver.observe(e[0])}focussed++}}};


inz.mediaCentre={};inz.mediaCentre.MediaCentreList=function(){this.elements={search_widget:$("#media_centre_search_widget"),search_topic:$("#media_centre_search_topic"),search_query:$("#media_centre_search_query"),search_button:$("#media_centre_search_button"),media_centre_page_list:$("#media_centre_page_list"),show_more:$("#media_centre_page_listing_show_more"),no_results:$("#media_centre_page_listing_search_no_results"),search_summary:$("#media_centre_search_results_summary")};this.state={next:0};this.readFromHash();var self=this;this.elements.search_button.click(function(){self.writeToHash();self.performSearch()});this.elements.search_query.on("keypress",function(e){if(e.keyCode===13){e.preventDefault();e.stopPropagation();self.elements.search_button.click()}});this.elements.show_more.find("button").click(function(){self.showMore()})};inz.mediaCentre.MediaCentreList.prototype.writeToHash=function(){var topic=this.elements.search_topic.val();var query=this.elements.search_query.val();var hash=topic||query?(topic?encodeURI(topic):"")+(query?"|"+encodeURI(query):""):"";if(window.location.hash!==hash){window.location.hash=hash}};inz.mediaCentre.MediaCentreList.prototype.readFromHash=function(){var hashParts=window.location.hash.substring(1).split("|");this.elements.search_topic.val(decodeURI(hashParts[0]));this.elements.search_query.val(hashParts.length>1?decodeURI(hashParts[1]):"")};inz.mediaCentre.MediaCentreList.prototype.performSearch=function(){this.elements.media_centre_page_list.empty();this.elements.show_more.hide();this.elements.no_results.hide();this.elements.search_summary.hide().empty();this.state.next=null;this.sendSearchRequest()};inz.mediaCentre.MediaCentreList.prototype.showMore=function(){this.elements.show_more.hide();this.sendSearchRequest()};inz.mediaCentre.MediaCentreList.prototype.sendSearchRequest=function(){var self=this;$.ajax({url:this.elements.search_widget.data("searchUrl"),cache:true,data:{topic:this.elements.search_topic.val(),query:this.elements.search_query.val(),next:this.state.next},success:function(data){self.processData(data)}})};inz.mediaCentre.MediaCentreList.prototype.renderListing=function(page){var self=this;var imageElement=null;var listing=$("<div>",{"class":"media_centre_page_listing"});if(page["image_url"]){var imageObject={"class":"media_centre_page_listing_lead_image advanced_image_background","style":page["image_attributes"]["style"]};for(var x in page["image_attributes"]){if(x.substr(0,4)==="data"){imageObject[x]=page["image_attributes"][x]}}if(page["url"]){imageObject["click"]=function(){window.location=page["url"]}}var imageDiv=$("<div>",imageObject);listing.append(imageDiv);imageElement=imageDiv[0]}var listingText=$("<div>",{"class":"media_centre_page_listing_text"});var listingTitles=$("<div>",{"class":"media_centre_page_listing_titles"});listingTitles.append($("<h3>").append($("<a>",{href:page["url"],text:page["title"]})));if(page["subtitle"]){listingTitles.append($("<p>",{text:page["subtitle"]}))}listingText.append(listingTitles);var listingMetadata=$("<div>",{"class":"media_centre_page_listing_metadata"});var dart=$("<div>",{"class":"media_centre_page_media_date_and_reading_time"});dart.append($("<div>",{"class":"media_centre_page_media_date",text:page["media_date"]}));dart.append($("<div>",{"class":"media_centre_page_reading_time",text:page["reading_time"]}));listingMetadata.append(dart);var tat=$("<div>",{"class":"media_centre_page_listing_tags_and_type"});if(page["tags"]&&page["tags"].length){var tags=$("<span>",{"class":"media_centre_page_listing_tags"});for(var n=0;n<page["tags"].length;n++){if(n>0){tags.append(document.createTextNode(" "))}var tag=$("<a>",{href:page["tags"][n]["url"],text:page["tags"][n]["title"]});var tagURL=page["tags"][n]["url"];var tagUID=/.*?[#]([0-9A-Fa-f]{32})/.exec(tagURL);if(tagUID){tag.data("tag",tagUID);tag.click(function(e){e.preventDefault();e.stopPropagation();self.handleTagLinkClick($(this).data("tag"))})}tags.append(tag)}tat.append(tags)}listingMetadata.append(tat);listingText.append(listingMetadata);listing.append(listingText);this.elements.media_centre_page_list.append(listing);if(imageElement!==null){inz.advancedImages.updateFocusPoint(imageElement);if(typeof inz.advancedImages.edit==="object"&&typeof inz.advancedImages.edit.register==="function"){inz.advancedImages.edit.register(imageElement)}}};inz.mediaCentre.MediaCentreList.prototype.renderSearchResult=function(page){var imageElement=null;var listing=$("<div>",{"class":"media_centre_page_listing search_result"});var topRow=$("<div>");topRow.append($("<h3>").append($("<a>",{href:page["url"],text:page["title"]})));topRow.append($("<p>",{text:page["subtitle"]?page["subtitle"]:""}));listing.append(topRow);var bottomRow=$("<div>");var dart=$("<div>",{"class":"media_centre_page_media_date_and_reading_time"});dart.append($("<div>",{"class":"media_centre_page_media_date",text:page["media_date"]}));dart.append($("<div>",{"class":"media_centre_page_reading_time",text:page["reading_time"]}));bottomRow.append(dart);listing.append(bottomRow);this.elements.media_centre_page_list.append(listing);if(imageElement!==null){inz.advancedImages.updateFocusPoint(imageElement);if(typeof inz.advancedImages.edit==="object"&&typeof inz.advancedImages.edit.register==="function"){inz.advancedImages.edit.register(imageElement)}}};inz.mediaCentre.MediaCentreList.prototype.handleTagLinkClick=function(tag){var needsScroll=!this.isSearchWidgetInView();this.elements.search_topic.val(tag);this.elements.search_topic.trigger("change.select2");this.elements.search_query.val("");this.elements.search_button.click();if(needsScroll){this.elements.search_widget[0].scrollIntoView({block:"center"})}};inz.mediaCentre.MediaCentreList.prototype.isSearchWidgetInView=function(){var widgetTop=this.elements.search_widget.offset().top;var widgetBottom=widgetTop+this.elements.search_widget.outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).height();return widgetBottom>viewportTop&&widgetTop<viewportBottom};inz.mediaCentre.MediaCentreList.prototype.updateSearchSummary=function(data){if(data["explicit_search"]){var summaryText="Results 1-"+(data["next"]?data["next"]:data["result_count"])+" of "+data["result_count"];if(data["search_tag"]||data["search_query"]){summaryText+=" for "}if(data["search_tag"]){summaryText+=data["search_tag"]}if(data["search_tag"]&&data["search_query"]){summaryText+=" / "}if(data["search_query"]){summaryText+=data["search_query"]}this.elements.search_summary.text(summaryText).show()}else{this.elements.search_summary.hide().empty()}};inz.mediaCentre.MediaCentreList.prototype.processData=function(data){this.elements.media_centre_page_list.toggleClass("search_results",data["explicit_search"]);if(data["pages"].length<1){this.elements.no_results.show()}for(var n=0;n<data["pages"].length;n++){if(data["explicit_search"]){this.renderSearchResult(data["pages"][n])}else{this.renderListing(data["pages"][n])}}this.state.next=data["next"];this.elements.show_more.toggle(data["next"]!==null);this.updateSearchSummary(data)};


$(document).on("ajaxpages:contentloaded",function(e,data){var dockTools=$("#docked_sliding_panel .dock_tools");dockTools.find(".document_action").remove();var sliderDocumentActions=$(".slider_document_actions");if(sliderDocumentActions.length){sliderDocumentActions.css("display","none");sliderDocumentActions.find(".document_action").clone().appendTo(dockTools.find(".tools_secondary"))}});
